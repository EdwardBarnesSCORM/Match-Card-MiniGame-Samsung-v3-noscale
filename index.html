<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, viewport-fit=cover" />
<title>Samsung Memory Game</title>
<style>
  :root { --w:382px; --h:780px; }
  body {
    margin:0; font-family:system-ui, Arial, sans-serif;
    text-align:center; padding:2rem; background:#f8f8f8;
  }
  h1 { margin-top:0; }
  .btn {
    padding:.75rem 1.25rem; border:0; border-radius:10px;
    background:#111; color:#fff; font-size:1rem; cursor:pointer;
  }

  /* Lightbox overlay */
  .lightbox {
    position: fixed; inset: 0;
    display:none; align-items:center; justify-content:center;
    background:rgba(0,0,0,.72); z-index:9999; overflow:hidden;
    padding:
      max(16px, env(safe-area-inset-top))
      max(16px, env(safe-area-inset-right))
      max(16px, env(safe-area-inset-bottom))
      max(16px, env(safe-area-inset-left));
  }
  .lightbox.active { display:flex; }

  /* Stage: NO transform. We size it with real px to avoid sub-pixel crop */
  .stage {
    position:relative;
    width: var(--w); height: var(--h);
    background:#000; border-radius:12px; overflow:hidden;
    box-shadow:0 20px 60px rgba(0,0,0,.6);
    box-sizing:border-box;
  }
  .stage iframe {
    width:100%; height:100%; border:0; display:block;
  }

  .close {
    position:absolute; top:10px; right:12px; z-index:2;
    border:0; background:rgba(0,0,0,.6); color:#fff;
    border-radius:8px; padding:6px 10px; font-size:16px; cursor:pointer;
  }
</style>
</head>
<body>
  <h1>Play the Samsung Memory Game</h1>
  <p>Opens in a lightbox emulator, similar to how it would look on a LMS (Samsung Circle) THIS EMULATED VERSION IS NOT DESIGNED FOR MOBILE. For mobile use this link: https://edwardbarnesscorm.github.io/Match-Cards-MiniGame-Samsung-v2</p>
  <button class="btn" id="open">Open Game</button>

  <div class="lightbox" id="box" aria-hidden="true">
    <div class="stage" id="stage" role="dialog" aria-modal="true" aria-label="Game">
      <button class="close" id="close" aria-label="Close">âœ•</button>
      <iframe src="game.html" allowfullscreen></iframe>
    </div>
  </div>

<script>
  const box   = document.getElementById('box');
  const stage = document.getElementById('stage');
  const openB = document.getElementById('open');
  const closeB= document.getElementById('close');

  const W = 382, H = 780;        // native size
  const GAP = 2;                 // tiny safety margin (px)

  function viewportSize() {
    const vv = window.visualViewport;
    return vv ? { w: vv.width, h: vv.height }
              : { w: document.documentElement.clientWidth,
                  h: document.documentElement.clientHeight };
  }

  function fitBoxToViewport() {
    const { w, h } = viewportSize();

    // account for overlay padding (safe areas included)
    const cs   = getComputedStyle(box);
    const padX = parseFloat(cs.paddingLeft) + parseFloat(cs.paddingRight);
    const padY = parseFloat(cs.paddingTop)  + parseFloat(cs.paddingBottom);

    const availW = Math.max(0, w - padX - GAP);
    const availH = Math.max(0, h - padY - GAP);

    // scale to fit, but never upscale beyond native
    const scale = Math.min(availW / W, availH / H, 1);

    // use integer pixel sizes to avoid sub-pixel rounding crop
    const targetW = Math.floor(W * scale);
    const targetH = Math.floor(H * scale);

    stage.style.width  = targetW + 'px';
    stage.style.height = targetH + 'px';
  }

  openB.addEventListener('click', () => {
    box.classList.add('active');
    box.setAttribute('aria-hidden','false');
    fitBoxToViewport();
  });

  closeB.addEventListener('click', () => {
    box.classList.remove('active');
    box.setAttribute('aria-hidden','true');
  });

  // close if user taps outside the stage
  box.addEventListener('click', e => { if (e.target === box) closeB.click(); });

  // refit on rotate/resize/URL bar transitions
  window.addEventListener('resize', fitBoxToViewport);
  window.addEventListener('orientationchange', fitBoxToViewport);
  if (window.visualViewport) {
    visualViewport.addEventListener('resize', fitBoxToViewport);
    visualViewport.addEventListener('scroll', fitBoxToViewport);
  }
</script>
</body>
</html>
